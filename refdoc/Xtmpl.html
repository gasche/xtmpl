<!DOCTYPE HTML>
<html>
<head>
<title>Xtmpl : Xtmpl reference documentation : Xtmpl</title><meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<link href="https://zoggy.github.io/xtmpl/style.css" rel="stylesheet" type="text/css"/>
<rssfeed></rssfeed>
</head><body>
<div id="page">
<div class="navbar navbar-fixed-top">
<div class="navbar-inner">
<div class="container">

  <div class="nav-collapse">
  <ul class="nav">
    <li class="&lt;navbar-home/&gt;"><a href="https://zoggy.github.io/xtmpl/">Xtmpl</a></li>
    <li class="&lt;navbar-download/&gt;"><a href="https://zoggy.github.io/xtmpl/download.html">Download/Install</a></li>
    <li class="active"><a href="https://zoggy.github.io/xtmpl/doc.html">Documentation</a></li>
    <li class="&lt;navbar-blog/&gt;"><a href="https://zoggy.github.io/xtmpl/blog.html">Blog</a></li>
    <li class="&lt;navbar-about/&gt;"><a href="https://zoggy.github.io/xtmpl/about.html">?</a></li>
  </ul>
  </div>
  <div class="nav pull-right">

  </div>
</div>
</div>
</div>

<div id="header">


</div>
<span></span>

<div class="ocamldoc-page">
<div class="navbar"> <a class="up" href="index.html" title="Index">Up</a>
 <a class="post" href="Xtmpl_xhtml.html" title="Xtmpl_xhtml">Next</a>
</div>
<h1>Module <a href="type_Xtmpl.html">Xtmpl</a></h1>

<pre><span class="keyword">module</span> Xtmpl: <code class="code">sig</code> <a href="Xtmpl.html">..</a> <code class="code">end</code></pre><div class="info module top">
Xml templating library.
<div class="vertical-space"> </div>

    Rewrite XML <a href="Xtmpl.html#TYPEtree"><code class="code">Xtmpl.tree</code></a>s using <a href="Xtmpl.html#TYPEcallback"><code class="code">Xtmpl.callback</code></a> rules
    provided by the <a href="Xtmpl.html#TYPEenv"><code class="code">Xtmpl.env</code></a> environment.
<div class="vertical-space"> </div>

    A complete description of the templating rules is available in the
    <a href="Xtmpl.html#engine"><i>Templating engine</i></a> section below.<br/>
</div>
<hr width="100%"/>
<br/>
<div class="section-title" id="2_XMLtrees">XML trees</div><br/>

<pre><span id="TYPEname"><span class="keyword">type</span> name</span> = <code class="type">string * string</code> </pre>
<div class="info">
A name is a pair <code class="code">(prefix, s)</code>, where prefix can be the empty string.
  When the prefix is not empty, it corresponds to the notation <code class="code">prefix:foo</code>
  for XML tags and attribute names.<br/>
</div>


<pre><span class="keyword">module</span> <a href="Xtmpl.Name_ord.html">Name_ord</a>: <code class="type">Map.OrderedType</code><code class="type">  with type t = name</code></pre>
<pre><span class="keyword">module</span> <a href="Xtmpl.Name_map.html">Name_map</a>: <code class="type">Map.S</code><code class="type">  with type key = name</code></pre><div class="info">
Mapping over names.
</div>

<pre><span class="keyword">module</span> <a href="Xtmpl.Name_set.html">Name_set</a>: <code class="type">Set.S</code><code class="type">  with type elt = name</code></pre><div class="info">
Sets of names.
</div>

<pre><code><span id="TYPEtree"><span class="keyword">type</span> tree</span> = </code></pre><table class="typetable">
<tr>
<td align="left" valign="top">
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top">
<code><span id="TYPEELTtree.E"><span class="constructor">E</span></span> <span class="keyword">of</span> <code class="type"><a href="Xtmpl.html#TYPEname">name</a> * <a href="Xtmpl.html#TYPEattributes">attributes</a> * <a href="Xtmpl.html#TYPEtree">tree</a> list</code></code></td>

</tr>
<tr>
<td align="left" valign="top">
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top">
<code><span id="TYPEELTtree.D"><span class="constructor">D</span></span> <span class="keyword">of</span> <code class="type">string</code></code></td>

</tr></table>



<pre><span id="TYPEattributes"><span class="keyword">type</span> attributes</span> = <code class="type">tree list Name_map.t</code> </pre>
<div class="info">
Attributes of a XML node. Note that the content value of an attribute is
      a list of XML trees, not just a string.<br/>
</div>


<pre><span id="VALstring_of_name"><span class="keyword">val</span> string_of_name</span> : <code class="type"><a href="Xtmpl.html#TYPEname">name</a> -&gt; string</code></pre><div class="info">
<pre class="codepre"><code class="code"> string_of_name (&quot;&quot;,s) = s
       string_of_name (p, s) = p ^ &quot;:&quot; ^ s </code></pre><br/>
</div>
<br/>
<div class="section-title" id="2_Constructors">Constructors</div><br/>

<pre><span id="VALnode"><span class="keyword">val</span> node</span> : <code class="type"><a href="Xtmpl.html#TYPEname">name</a> -&gt; ?atts:<a href="Xtmpl.html#TYPEattributes">attributes</a> -&gt; <a href="Xtmpl.html#TYPEtree">tree</a> list -&gt; <a href="Xtmpl.html#TYPEtree">tree</a></code></pre>
<pre><span id="VALcdata"><span class="keyword">val</span> cdata</span> : <code class="type">string -&gt; <a href="Xtmpl.html#TYPEtree">tree</a></code></pre><br/>
<div class="section-title" id="2_Attributes">Attributes</div>
<div class="vertical-space"> </div>

Here are some convenient functions to work with attributes: building, querying.<br/>

<pre><span id="VALatts_empty"><span class="keyword">val</span> atts_empty</span> : <code class="type"><a href="Xtmpl.html#TYPEattributes">attributes</a></code></pre><div class="info">
Empty <a href="Xtmpl.html#TYPEattributes"><code class="code">Xtmpl.attributes</code></a> structure.<br/>
</div>

<pre><span id="VALatts_of_list"><span class="keyword">val</span> atts_of_list</span> : <code class="type">?atts:<a href="Xtmpl.html#TYPEattributes">attributes</a> -&gt;<br/>       (<a href="Xtmpl.html#TYPEname">name</a> * <a href="Xtmpl.html#TYPEtree">tree</a> list) list -&gt; <a href="Xtmpl.html#TYPEattributes">attributes</a></code></pre><div class="info">
<code class="code">atts_of_list list</code> returns an <a href="Xtmpl.html#TYPEattributes"><code class="code">Xtmpl.attributes</code></a> structure from the given
  list of pairs <code class="code">(name, xml tree list) ; (name, xml tree list) ; ...</code>.
  The last  pair of the list is added first (using <code class="code">List.fold_right</code>).<br/>
</div>
<div class="param_info"><code class="code">atts</code> : can be used to specify an existing <a href="Xtmpl.html#TYPEattributes"><code class="code">Xtmpl.attributes</code></a> structure to
  add bindings to, instead of starting from an empty one.</div>

<pre><span id="VALatts_one"><span class="keyword">val</span> atts_one</span> : <code class="type">?atts:<a href="Xtmpl.html#TYPEattributes">attributes</a> -&gt; <a href="Xtmpl.html#TYPEname">name</a> -&gt; <a href="Xtmpl.html#TYPEtree">tree</a> list -&gt; <a href="Xtmpl.html#TYPEattributes">attributes</a></code></pre><div class="info">
<code class="code">atts_one ?atts name xmls</code> is like <a href="Xtmpl.html#VALatts_of_list"><code class="code">Xtmpl.atts_of_list</code></a> but for one attribute.<br/>
</div>

<pre><span id="VALatts_remove"><span class="keyword">val</span> atts_remove</span> : <code class="type"><a href="Xtmpl.html#TYPEname">name</a> -&gt; <a href="Xtmpl.html#TYPEattributes">attributes</a> -&gt; <a href="Xtmpl.html#TYPEattributes">attributes</a></code></pre><div class="info">
<code class="code">atts_remove name attributes</code> removes the binding to <code class="code">name</code> from the
  <code class="code">attributes</code>.<br/>
</div>

<pre><span id="VALatts_replace"><span class="keyword">val</span> atts_replace</span> : <code class="type"><a href="Xtmpl.html#TYPEname">name</a> -&gt; <a href="Xtmpl.html#TYPEtree">tree</a> list -&gt; <a href="Xtmpl.html#TYPEattributes">attributes</a> -&gt; <a href="Xtmpl.html#TYPEattributes">attributes</a></code></pre><div class="info">
<code class="code">atts_replace name xmls attributes</code> adds a new bindings from <code class="code">name</code> to
  <code class="code">xmls</code> in <code class="code">attributes</code>. If <code class="code">name</code> was previously bound, the previous
  binding is removed.
  <code class="code">atts_replace ~atts name xmls</code> is equivalent to <code class="code">atts_replace name xmls atts</code>.<br/>
</div>

<pre><span id="VALget_att"><span class="keyword">val</span> get_att</span> : <code class="type"><a href="Xtmpl.html#TYPEattributes">attributes</a> -&gt; <a href="Xtmpl.html#TYPEname">name</a> -&gt; <a href="Xtmpl.html#TYPEtree">tree</a> list option</code></pre><div class="info">
<code class="code">get_att attributes name</code> returns the xml tree list bound to <code class="code">name</code> in
  <code class="code">attributes</code>. Return <code class="code">None</code> if no binding was found for <code class="code">name</code>.<br/>
<b>Since</b> 0.11<br/>
</div>

<pre><span id="VALget_att_cdata"><span class="keyword">val</span> get_att_cdata</span> : <code class="type"><a href="Xtmpl.html#TYPEattributes">attributes</a> -&gt; <a href="Xtmpl.html#TYPEname">name</a> -&gt; string option</code></pre><div class="info">
Same as <a href="Xtmpl.html#VALget_att"><code class="code">Xtmpl.get_att</code></a> but return a string <code class="code">s</code> only if <code class="code">name</code> is bound to
  a single CDATA XML node (<code class="code">[D s]</code>).
  In particular, if <code class="code">name</code> is bound to a list of XML tree, or to
  a single tree which is not a CDATA, the function returns <code class="code">None</code>.<br/>
<b>Since</b> 0.11<br/>
</div>

<pre><span id="VALopt_att"><span class="keyword">val</span> opt_att</span> : <code class="type"><a href="Xtmpl.html#TYPEattributes">attributes</a> -&gt; ?def:<a href="Xtmpl.html#TYPEtree">tree</a> list -&gt; <a href="Xtmpl.html#TYPEname">name</a> -&gt; <a href="Xtmpl.html#TYPEtree">tree</a> list</code></pre><div class="info">
<code class="code">opt_att attributes ?def name</code> returns the tree list associated to <code class="code">name</code>
  in the <code class="code">attributes</code> or a default value. This default value can be
  specified with the <code class="code">def</code> parameter. If no default value is specified, then
  the empty list is used.<br/>
<b>Since</b> 0.11<br/>
</div>

<pre><span id="VALopt_att_cdata"><span class="keyword">val</span> opt_att_cdata</span> : <code class="type"><a href="Xtmpl.html#TYPEattributes">attributes</a> -&gt; ?def:string -&gt; <a href="Xtmpl.html#TYPEname">name</a> -&gt; string</code></pre><div class="info">
Same as <a href="Xtmpl.html#VALopt_att"><code class="code">Xtmpl.opt_att</code></a> but looking for CDATA bounded values, as in
  <a href="Xtmpl.html#VALget_att_cdata"><code class="code">Xtmpl.get_att_cdata</code></a>.<br/>
<b>Since</b> 0.11<br/>
</div>

<pre><span id="VALstring_of_atts"><span class="keyword">val</span> string_of_atts</span> : <code class="type"><a href="Xtmpl.html#TYPEattributes">attributes</a> -&gt; string</code></pre><div class="info">
Return a string representation of attributes, in the form
    <code class="code">a=&quot;foo&quot; b=&quot;bar&quot; ...</code>.
    Note that the attribute names are output verbatim, but the
    attribute values are escaped with the <code class="code">%S</code> format.<br/>
</div>
<br/>
<div class="section-title" id="2_Environment">Environment</div>
<div class="vertical-space"> </div>

    An <a href="Xtmpl.html#TYPEenv"><code class="code">Xtmpl.env</code></a> is a <a href="Xtmpl.html#TYPEname"><code class="code">Xtmpl.name</code></a>-to-<a href="Xtmpl.html#TYPEcallback"><code class="code">Xtmpl.callback</code></a> associative map. In addition
    to basic manipulation functions, the functions <a href="Xtmpl.html#VALenv_add_xml"><code class="code">Xtmpl.env_add_xml</code></a> and
    <a href="Xtmpl.html#VALenv_of_list"><code class="code">Xtmpl.env_of_list</code></a> provide convenient shortcuts for common operations.
<div class="vertical-space"> </div>

    The environments are immutable, all mutating operations return new
    environments.<br/>

<pre><span id="TYPEenv"><span class="keyword">type</span> <code class="type">'a</code> env</span> </pre>


<pre><span id="TYPEcallback"><span class="keyword">type</span> <code class="type">'a</code> callback</span> = <code class="type">'a -&gt; 'a env -&gt; <a href="Xtmpl.html#TYPEattributes">attributes</a> -&gt; <a href="Xtmpl.html#TYPEtree">tree</a> list -&gt; 'a * <a href="Xtmpl.html#TYPEtree">tree</a> list</code> </pre>
<div class="info">
A <code class="code">'a callback</code> takes data of type <code class="code">'a</code>, a <code class="code">'a env</code>, attributes and XML nodes.
    It returns a potentially new data of type <code class="code">'a</code> and XML nodes. The attributes are
    the attributes of the node being rewritten, and the XML trees in parameter are the
    XML children of this node. The environment must be a <code class="code">'a env</code> so that
    if can be used in the callback to perform rewriting, returning a
    new data of type <code class="code">'a</code>.<br/>
</div>


<pre><span id="EXCEPTIONNo_change"><span class="keyword">exception</span> No_change</span></pre>
<div class="info">
This exception can be raised by callbacks to indicate that the
  node to be rewritten remains unchanged.<br/>
</div>

<pre><span id="VALenv_empty"><span class="keyword">val</span> env_empty</span> : <code class="type">unit -&gt; 'a <a href="Xtmpl.html#TYPEenv">env</a></code></pre><div class="info">
An environment that contains only one binding, associating
  <a href="Xtmpl.html#VALtag_main"><code class="code">Xtmpl.tag_main</code></a> to a function such as <code class="code">(fun data _env _atts subs -&gt; (data, subs))</code>,
  i.e. only returning the given data and subnodes.<br/>
</div>

<pre><span id="VALenv_add_cb"><span class="keyword">val</span> env_add_cb</span> : <code class="type">?prefix:string -&gt; string -&gt; 'a <a href="Xtmpl.html#TYPEcallback">callback</a> -&gt; 'a <a href="Xtmpl.html#TYPEenv">env</a> -&gt; 'a <a href="Xtmpl.html#TYPEenv">env</a></code></pre><div class="info">
Add a binding to an environment.
<div class="vertical-space"> </div>

    <code class="code">env_add_cb &quot;double&quot; (fun acc _ _ xml -&gt; (acc, xml @ xml))</code> binds the key
    <code class="code">(&quot;&quot;, &quot;double&quot;)</code> to a callback that doubles an XML subtree.
<div class="vertical-space"> </div>

    <code class="code">env_add_cb ~prefix: &quot;foo&quot; &quot;double&quot; (fun acc _ _ xml -&gt; (acc, xml @ xml))</code> does the same but
    for the key  <code class="code">(&quot;foo&quot;, &quot;double&quot;)</code>.
<div class="vertical-space"> </div>

    If the same key was already bound, the previous binding is replaced.<br/>
</div>
<div class="param_info"><code class="code">prefix</code> : is <code class="code">&quot;&quot;</code> by default.</div>

<pre><span id="VALenv_add_xml"><span class="keyword">val</span> env_add_xml</span> : <code class="type">?prefix:string -&gt; string -&gt; <a href="Xtmpl.html#TYPEtree">tree</a> list -&gt; 'a <a href="Xtmpl.html#TYPEenv">env</a> -&gt; 'a <a href="Xtmpl.html#TYPEenv">env</a></code></pre><div class="info">
Bind a callback that returns some XML.
<div class="vertical-space"> </div>

    The most frequent operation performed by a callback is to return
    constant XML subtrees. This convenience function lets you provide
    the XML subtrees.
<div class="vertical-space"> </div>

    <code class="code">env_add_xml &quot;logo&quot; [ E ((&quot;&quot;,&quot;img&quot;), atts_one (&quot;&quot;,&quot;src&quot;) [D &quot;logo.png&quot;], []) ] env</code>
    binds the key <code class="code">(&quot;&quot;,&quot;logo&quot;)</code> to a callback that returns an XHTML image tag.<br/>
</div>
<div class="param_info"><code class="code">prefix</code> : can be used to specify a prefix for the rule name. Default is <code class="code">&quot;&quot;</code>.</div>

<pre><span id="VALenv_get"><span class="keyword">val</span> env_get</span> : <code class="type"><a href="Xtmpl.html#TYPEname">name</a> -&gt; 'a <a href="Xtmpl.html#TYPEenv">env</a> -&gt; 'a <a href="Xtmpl.html#TYPEcallback">callback</a> option</code></pre><div class="info">
Get a binding from an environment.
<div class="vertical-space"> </div>

    If the binding is not found, returns <code class="code">None</code>.<br/>
</div>

<pre><span id="VALstring_of_env"><span class="keyword">val</span> string_of_env</span> : <code class="type">'a <a href="Xtmpl.html#TYPEenv">env</a> -&gt; string</code></pre><div class="info">
String representation of all the keys in the environment.<br/>
</div>

<pre><span id="VALenv_of_list"><span class="keyword">val</span> env_of_list</span> : <code class="type">?env:'a <a href="Xtmpl.html#TYPEenv">env</a> -&gt; (<a href="Xtmpl.html#TYPEname">name</a> * 'a <a href="Xtmpl.html#TYPEcallback">callback</a>) list -&gt; 'a <a href="Xtmpl.html#TYPEenv">env</a></code></pre><div class="info">
Add several bindings at once.
<div class="vertical-space"> </div>

    This convenience function saves you the effort of calling
    <a href="Xtmpl.html#VALenv_add_cb"><code class="code">Xtmpl.env_add_cb</code></a> several times yourself.
<div class="vertical-space"> </div>

    <code class="code">env_of_list ~env:env [ (ns1, k1), f1 ; (ns2, k2), f2 ]</code> is equivalent to
    <code class="code">env_add_cb ~prefix: ns1 k1 f1 (env_add_cb ~prefix: ns2 k2 f2 env)</code>. This means that one key
    is present twice in the list, the first association in the list
    will hide the second one in the resulting environment.<br/>
</div>
<div class="param_info"><code class="code">env</code> : The environment to which bindings are added. If
    not provided, <a href="Xtmpl.html#VALenv_empty"><code class="code">Xtmpl.env_empty</code></a><code class="code"> ()</code> is used.</div>
<br/>
<div class="section-title" id="2_Specialtagsandattributes">Special tags and attributes</div><br/>

<pre><span id="VALtag_main"><span class="keyword">val</span> tag_main</span> : <code class="type">string</code></pre><div class="info">
A dummy tag, currently <code class="code">&quot;main_&quot;</code>. It is used when parsing a
   string as an XML tree, to ensure that we will parse a tree and
   not a list of trees. For this purpose, the tag is used to enclosed
   a string before parsing it.
<div class="vertical-space"> </div>

   Used by <a href="Xtmpl.html#VALxml_of_string"><code class="code">Xtmpl.xml_of_string</code></a> and, most importantly, by the
     <a href="Xtmpl.html#VALapply_to_string"><code class="code">Xtmpl.apply_to_string</code></a>, <a href="Xtmpl.html#VALapply_to_file"><code class="code">Xtmpl.apply_to_file</code></a>, <a href="Xtmpl.html#VALapply_into_file"><code class="code">Xtmpl.apply_into_file</code></a> and
     <a href="Xtmpl.html#VALapply_string_into_file"><code class="code">Xtmpl.apply_string_into_file</code></a> functions.<br/>
</div>

<pre><span id="VALtag_env"><span class="keyword">val</span> tag_env</span> : <code class="type">string</code></pre><div class="info">
The environment tag, currently <code class="code">&quot;env_&quot;</code>.
<div class="vertical-space"> </div>

    See the template rules in the <a href="Xtmpl.html#engine"><i>Templating engine</i></a> section below for more
    information about this tag.<br/>
</div>

<pre><span id="VALatt_defer"><span class="keyword">val</span> att_defer</span> : <code class="type">string</code></pre><div class="info">
The defer attribute, currently <code class="code">&quot;defer_&quot;</code>. See the engine section
  for details.<br/>
</div>

<pre><span id="VALatt_escamp"><span class="keyword">val</span> att_escamp</span> : <code class="type">string</code></pre><div class="info">
The escamp attribute, currently <code class="code">&quot;escamp_&quot;</code>. This attribute
  is used when converting XML to string or reading XML from a string.
  The CDATA associated to this attribute indicates the other attributes
  in which the ampersands must be escaped (when parsing XML from an
  attribute string) or unescaped (when printing XML to an attribute string).
  This is useful for urls with &amp;, for example in <code class="code">&lt;a href=&quot;...&quot;&gt;</code> nodes.
<div class="vertical-space"> </div>

  Example: In <code class="code">&lt;a escamp_=&quot;href&quot;, href=&quot;http://foo.fr?v1=3amp;v2=4&quot;&gt;...&lt;/a&gt;</code>.
  As attributes are parsed as XML, setting the <code class="code">escamp_</code> attribute to <code class="code">&quot;href&quot;</code>
  will make the ampersand escaped. The attribute is kept during rewriting.
  When the XML tree will be converted to a string, the <code class="code">escamp_</code> attribute
  will be removed. Several attribute names can be indicated, using <code class="code">','</code>
  or <code class="code">';'</code> as separator, as in
  <code class="code"> &lt;a escamp_=&quot;href, foo, gee:buz&quot; href=&quot;...&quot; ...&gt;...&lt;/a&gt; </code>.
<div class="vertical-space"> </div>

  This treatment is done in <a href="Xtmpl.html#VALxmls_of_atts"><code class="code">Xtmpl.xmls_of_atts</code></a> (escaping) and <a href="Xtmpl.html#VALstring_of_xml_atts"><code class="code">Xtmpl.string_of_xml_atts</code></a> (unescaping).<br/>
</div>

<pre><span id="VALatt_protect"><span class="keyword">val</span> att_protect</span> : <code class="type">string</code></pre><div class="info">
The protect attribute, currently &quot;protect_&quot;. See the engine section
  for details. This attribute is removed when a XML tree is converted
  to a string, as for <a href="Xtmpl.html#VALatt_escamp"><code class="code">Xtmpl.att_escamp</code></a>.<br/>
</div>
<br/>
<div class="section-title" id="2_XMLManipulation">XML Manipulation</div><br/>

<pre><span id="VALmerge_cdata"><span class="keyword">val</span> merge_cdata</span> : <code class="type"><a href="Xtmpl.html#TYPEtree">tree</a> -&gt; <a href="Xtmpl.html#TYPEtree">tree</a></code></pre><div class="info">
Recursively merge sibling <code class="code">D</code> nodes into one <code class="code">D</code> node.<br/>
</div>

<pre><span id="VALmerge_cdata_list"><span class="keyword">val</span> merge_cdata_list</span> : <code class="type"><a href="Xtmpl.html#TYPEtree">tree</a> list -&gt; <a href="Xtmpl.html#TYPEtree">tree</a> list</code></pre><div class="info">
Same as <a href="Xtmpl.html#VALmerge_cdata"><code class="code">Xtmpl.merge_cdata</code></a> but taking a <a href="Xtmpl.html#TYPEtree"><code class="code">Xtmpl.tree</code></a> list.
<div class="vertical-space"> </div>
Output an XML string.
<div class="vertical-space"> </div>

    The returned string does not include the initial <code class="code">&lt;?xml ... ?&gt;</code>.<br/>
</div>

<pre><span id="VALstring_of_xml"><span class="keyword">val</span> string_of_xml</span> : <code class="type">?xml_atts:bool -&gt; <a href="Xtmpl.html#TYPEtree">tree</a> -&gt; string</code></pre>
<pre><span id="VALstring_of_xmls"><span class="keyword">val</span> string_of_xmls</span> : <code class="type">?xml_atts:bool -&gt; <a href="Xtmpl.html#TYPEtree">tree</a> list -&gt; string</code></pre><div class="info">
Use <a href="Xtmpl.html#VALstring_of_xml"><code class="code">Xtmpl.string_of_xml</code></a> to concatenate a list of xml trees into one string,
  with no separator.<br/>
</div>

<pre><span id="VALstring_of_xml_atts"><span class="keyword">val</span> string_of_xml_atts</span> : <code class="type">?xml_atts:bool -&gt; <a href="Xtmpl.html#TYPEattributes">attributes</a> -&gt; (<a href="Xtmpl.html#TYPEname">name</a> * string) list</code></pre><div class="info">
Return a list of strings to represent the given attributes.<br/>
</div>

<pre><span id="VALxml_of_string"><span class="keyword">val</span> xml_of_string</span> : <code class="type">?add_main:bool -&gt; string -&gt; <a href="Xtmpl.html#TYPEtree">tree</a></code></pre><div class="info">
Parses a string as XML.<br/>
<b>Raises</b> <code>Failure</code> when a parsing error occurs, including the source string.<br/>
</div>
<div class="param_info"><code class="code">add_main</code> : if true (default), adds <code class="code">&lt;main_&gt;..&lt;/main_&gt;</code> around the string
    (see <a href="Xtmpl.html#VALtag_main"><code class="code">Xtmpl.tag_main</code></a>).</div>

<pre><span id="VALxmls_of_atts"><span class="keyword">val</span> xmls_of_atts</span> : <code class="type">(<a href="Xtmpl.html#TYPEname">name</a> * string) list -&gt; <a href="Xtmpl.html#TYPEattributes">attributes</a></code></pre><div class="info">
Convert &quot;string attributes&quot; to an <a href="Xtmpl.html#TYPEattributes"><code class="code">Xtmpl.attributes</code></a> structure. The value
  associated to each name must be valid XML. See also <a href="Xtmpl.html#VALatt_escamp"><code class="code">Xtmpl.att_escamp</code></a>.<br/>
</div>

<pre><span id="VALxml_of_file"><span class="keyword">val</span> xml_of_file</span> : <code class="type">string -&gt; <a href="Xtmpl.html#TYPEtree">tree</a></code></pre><div class="info">
Same as <a href="Xtmpl.html#VALxml_of_string"><code class="code">Xtmpl.xml_of_string</code></a> but read from a file.<br/>
</div>
<br/>
<div class="section-title" id="engine">Templating engine</div>
<div class="vertical-space"> </div>

    The <code class="code">apply_*</code> functions apply a given environment and data to XML tree(s). These
    trees are given as parameter (<a href="Xtmpl.html#VALapply_to_xmls"><code class="code">Xtmpl.apply_to_xmls</code></a>) or can be read from a
    file (<a href="Xtmpl.html#VALapply_to_file"><code class="code">Xtmpl.apply_to_file</code></a>), or a string (<a href="Xtmpl.html#VALapply_to_string"><code class="code">Xtmpl.apply_to_string</code></a>).
<div class="vertical-space"> </div>

    The functions return the result of the rewrite as XML trees, or
    can write it to a file (<a href="Xtmpl.html#VALapply_into_file"><code class="code">Xtmpl.apply_into_file</code></a>). They also return data
    as the result of the callbacks called, as in a classic fold function (callbacks
    take the data in parameter, as the environment, the attributes and subnodes
    of the rewritten node).
<div class="vertical-space"> </div>

    The rewrite rules are applied until a fix-point is reached.
    If the <code class="code">XTMPL_FIXPOINT_LIMIT</code> environment variable contains a valid integer <code class="code">n</code>,
    it is used as a fix-point limit: if no fix-point is reached in <code class="code">n</code> iterations,
    then a <code class="code">Failure</code> exception is raised.
<div class="vertical-space"> </div>

<OL>
<li>A single iteration descends recursively into the XML tree. If an
    element has a callback associated in the environment, then the
    callback is applied to the current data and the node's attributes and children.
<div class="vertical-space"> </div>

    <i>Example</i>: consider the following XML:
<div class="vertical-space"> </div>

    <pre class="verbatim">&lt;album author=&quot;Rammstein&quot; name=&quot;Reise, Reise&quot;&gt;
  &lt;track&gt;Los&lt;/track&gt;
  &lt;track&gt;Mein Teil&lt;/track&gt;
&lt;/album&gt;</pre>
<div class="vertical-space"> </div>

    This would look for a callback bound to <code class="code">(&quot;&quot;,&quot;album&quot;)</code> in the environment
    and call it using
    <code class="code">callback data env {(&quot;&quot;,&quot;author&quot;)-&gt;[ D &quot;Rammstein&quot;]|(&quot;&quot;,&quot;name&quot;)-&gt;[D &quot;Reise, Reise&quot;]} xml</code>
    where <code class="code">env</code> is the current environment and <code class="code">xml</code> represents the
    two children <code class="code"> &lt;track&gt;..&lt;/track&gt; </code> elements.
</li>
<li>The callback returns a pair composed of (maybe new) data
     and a new list of elements that is used instead of the old element.
<div class="vertical-space"> </div>

    <i>Example</i>: assuming that the environnement was build using
    <code class="code">env_add_cb &quot;x2&quot; (fun data _ _ xml -&gt; (data, xml @ xml)) env</code>,
    then <code class="code">&lt;x2&gt;A&lt;/x2&gt;</code> is rewritten as <code class="code">AA</code>.
</li>
<li>The engine then recursively descends into those replaced
    elements (this means that a poorly conceived rule set may well never
    terminate).
<div class="vertical-space"> </div>

    <i>Example</i>: <code class="code">&lt;x2&gt;&lt;x2&gt;A&lt;/x2&gt;&lt;/x2&gt;</code> is first rewritten as
    <code class="code">&lt;x2&gt;A&lt;/x2&gt;&lt;x2&gt;A&lt;/x2&gt;</code>, and then as <code class="code">AAAA</code>.
</li>
<li> The <code class="code">env_</code> and <code class="code">main_</code> elements (see <a href="Xtmpl.html#VALtag_env"><code class="code">Xtmpl.tag_env</code></a>
    and <a href="Xtmpl.html#VALtag_main"><code class="code">Xtmpl.tag_main</code></a>) are a special case: both are automatically
    replaced with their children (as if their callback was
    <code class="code">(fun data _ _ xml -&gt; (data, xml))</code>).
<div class="vertical-space"> </div>

    <code class="code">env_</code> effectively changes the environment
    used when processing its children by adding the bindings defined by
    its attributes (using <a href="Xtmpl.html#VALenv_add_xml"><code class="code">Xtmpl.env_add_xml</code></a>).
<div class="vertical-space"> </div>

    <i>Example</i>: <code class="code">&lt;env_ a=&quot;&amp;lt;b&amp;gt;A&amp;lt;/b&amp;gt;&quot;&gt;&lt;a/&gt;&lt;/env_&gt;</code> is
    replaced by <code class="code">&lt;a/&gt;</code>, which in turn is replaced by
    <code class="code">&lt;b&gt;A&lt;/b&gt;</code>.
</li>
<li>If an element has a <code class="code">defer_</code> attribute (that is greater
    than zero), then it is not processed and the attribute is decremented
    by one, and the process recursively applies to its children.
<div class="vertical-space"> </div>

    <i>Example</i>: <code class="code">&lt;x2 defer_=&quot;1&quot;&gt;&lt;x2&gt;A&lt;/x2&gt;&lt;/x2&gt;</code> is rewritten as
    <code class="code">&lt;x2 defer_=&quot;0&quot;&gt;AA&lt;/x2&gt;</code>. The <b>next</b> iteration will effectively apply the
    rule to the node and return <code class="code">AAAA</code>.
</li>
<li> If an element has a <code class="code">protect_</code> attribute, then the value
    must be CDATA and contains a list of names to remove from the environment
    when descending in the children. The names are separated by <code class="code">','</code> or <code class="code">';'</code>,
    for example: <code class="code">&lt;foo protect_=&quot;title,id,foo:bar&quot; ..&gt;...&lt;/foo&gt;</code>.
</li>
</OL>
<br/>

<pre><span id="TYPErewrite_stack"><span class="keyword">type</span> rewrite_stack</span> = <code class="type">(<a href="Xtmpl.html#TYPEname">name</a> * <a href="Xtmpl.html#TYPEattributes">attributes</a> * <a href="Xtmpl.html#TYPEtree">tree</a> list) list</code> </pre>
<div class="info">
To catch eventual infinite loops in rewriting, we keep a
  stack of the rules called.<br/>
</div>


<pre><span id="EXCEPTIONLoop"><span class="keyword">exception</span> Loop</span> <span class="keyword">of</span> <code class="type"><a href="Xtmpl.html#TYPErewrite_stack">rewrite_stack</a></code></pre>
<div class="info">
The <code class="code">Loop</code> exception is raised when the rewrite stack
  is higher than a default value of 100. This value can be changed
  by setting the <code class="code">XTMPL_REWRITE_DEPTH_LIMIT</code> environment variable.
  Default value is <code class="code">100</code>.<br/>
</div>

<pre><span id="VALstring_of_stack"><span class="keyword">val</span> string_of_stack</span> : <code class="type"><a href="Xtmpl.html#TYPErewrite_stack">rewrite_stack</a> -&gt; string</code></pre><div class="info">
String representation of the given rewrite stack.<br/>
</div>

<pre><span id="VALapply_to_string"><span class="keyword">val</span> apply_to_string</span> : <code class="type">'a -&gt; 'a <a href="Xtmpl.html#TYPEenv">env</a> -&gt; string -&gt; 'a * <a href="Xtmpl.html#TYPEtree">tree</a> list</code></pre><div class="info">
Applies as many iterations as necessary to a piece of XML (represented
    as an unparsed string) to reach a fix-point.
<div class="vertical-space"> </div>

    See above for how an iteration is applied.<br/>
</div>

<pre><span id="VALapply_to_file"><span class="keyword">val</span> apply_to_file</span> : <code class="type">'a -&gt; 'a <a href="Xtmpl.html#TYPEenv">env</a> -&gt; string -&gt; 'a * <a href="Xtmpl.html#TYPEtree">tree</a> list</code></pre><div class="info">
As <a href="Xtmpl.html#VALapply_to_string"><code class="code">Xtmpl.apply_to_string</code></a>, but reads the XML from a file.<br/>
</div>

<pre><span id="VALapply_to_xmls"><span class="keyword">val</span> apply_to_xmls</span> : <code class="type">'a -&gt; 'a <a href="Xtmpl.html#TYPEenv">env</a> -&gt; <a href="Xtmpl.html#TYPEtree">tree</a> list -&gt; 'a * <a href="Xtmpl.html#TYPEtree">tree</a> list</code></pre><div class="info">
As <a href="Xtmpl.html#VALapply_to_string"><code class="code">Xtmpl.apply_to_string</code></a>, but applies to a list of XML trees.<br/>
</div>

<pre><span id="VALapply_into_file"><span class="keyword">val</span> apply_into_file</span> : <code class="type">'a -&gt; ?head:string -&gt; 'a <a href="Xtmpl.html#TYPEenv">env</a> -&gt; infile:string -&gt; outfile:string -&gt; 'a</code></pre><div class="info">
As <a href="Xtmpl.html#VALapply_to_file"><code class="code">Xtmpl.apply_to_file</code></a>, but writes the result back to a file.
<div class="vertical-space"> </div>

    For instance, <code class="code">apply_to_file data env ~infile:&quot;source.xml&quot; ~outfile: &quot;dest.xml&quot;</code>.<br/>
</div>
<div class="param_info"><code class="code">head</code> : Prepend this string to the XML that is output
    to the file. By default, nothing is prepended.</div>

<pre><span id="VALapply_string_into_file"><span class="keyword">val</span> apply_string_into_file</span> : <code class="type">'a -&gt; ?head:string -&gt; 'a <a href="Xtmpl.html#TYPEenv">env</a> -&gt; outfile:string -&gt; string -&gt; 'a</code></pre><div class="info">
As <a href="Xtmpl.html#VALapply_into_file"><code class="code">Xtmpl.apply_into_file</code></a>, but read the XML from a string instead of a file.<br/>
</div>
<br/>
<div class="section-title" id="2_Deprecatedfunctions">Deprecated functions</div><br/>

<pre><span id="VALget_arg"><span class="keyword">val</span> get_arg</span> : <code class="type"><a href="Xtmpl.html#TYPEattributes">attributes</a> -&gt; <a href="Xtmpl.html#TYPEname">name</a> -&gt; <a href="Xtmpl.html#TYPEtree">tree</a> list option</code></pre><div class="info">
<span class="warning">Deprecated.</span>Use <a href="Xtmpl.html#VALget_att"><code class="code">Xtmpl.get_att</code></a>.<br/>
</div>

<pre><span id="VALget_arg_cdata"><span class="keyword">val</span> get_arg_cdata</span> : <code class="type"><a href="Xtmpl.html#TYPEattributes">attributes</a> -&gt; <a href="Xtmpl.html#TYPEname">name</a> -&gt; string option</code></pre><div class="info">
<span class="warning">Deprecated.</span>Use <a href="Xtmpl.html#VALget_att_cdata"><code class="code">Xtmpl.get_att_cdata</code></a>.<br/>
</div>

<pre><span id="VALopt_arg"><span class="keyword">val</span> opt_arg</span> : <code class="type"><a href="Xtmpl.html#TYPEattributes">attributes</a> -&gt; ?def:<a href="Xtmpl.html#TYPEtree">tree</a> list -&gt; <a href="Xtmpl.html#TYPEname">name</a> -&gt; <a href="Xtmpl.html#TYPEtree">tree</a> list</code></pre><div class="info">
<span class="warning">Deprecated.</span>Use <a href="Xtmpl.html#VALopt_att"><code class="code">Xtmpl.opt_att</code></a>.<br/>
</div>

<pre><span id="VALopt_arg_cdata"><span class="keyword">val</span> opt_arg_cdata</span> : <code class="type"><a href="Xtmpl.html#TYPEattributes">attributes</a> -&gt; ?def:string -&gt; <a href="Xtmpl.html#TYPEname">name</a> -&gt; string</code></pre><div class="info">
<span class="warning">Deprecated.</span>Use <a href="Xtmpl.html#VALopt_att_cdata"><code class="code">Xtmpl.opt_att_cdata</code></a>.<br/>
</div>

<pre><span id="VALstring_of_args"><span class="keyword">val</span> string_of_args</span> : <code class="type"><a href="Xtmpl.html#TYPEattributes">attributes</a> -&gt; string</code></pre><div class="info">
<span class="warning">Deprecated.</span>Use <a href="Xtmpl.html#VALstring_of_atts"><code class="code">Xtmpl.string_of_atts</code></a>.<br/>
</div>

<pre><span id="VALenv_add"><span class="keyword">val</span> env_add</span> : <code class="type">?prefix:string -&gt; string -&gt; 'a <a href="Xtmpl.html#TYPEcallback">callback</a> -&gt; 'a <a href="Xtmpl.html#TYPEenv">env</a> -&gt; 'a <a href="Xtmpl.html#TYPEenv">env</a></code></pre><div class="info">
<span class="warning">Deprecated.</span>Use <a href="Xtmpl.html#VALenv_add_cb"><code class="code">Xtmpl.env_add_cb</code></a> instead.<br/>
</div>

<pre><span id="VALenv_add_att"><span class="keyword">val</span> env_add_att</span> : <code class="type">?prefix:string -&gt; string -&gt; <a href="Xtmpl.html#TYPEtree">tree</a> list -&gt; 'a <a href="Xtmpl.html#TYPEenv">env</a> -&gt; 'a <a href="Xtmpl.html#TYPEenv">env</a></code></pre><div class="info">
<span class="warning">Deprecated.</span>Use <a href="Xtmpl.html#VALenv_add_xml"><code class="code">Xtmpl.env_add_xml</code></a> instead.<br/>
</div>
</div>


</div>

<footer id="bottombar">
</footer>
<script src="https://zoggy.github.io/xtmpl/jquery.js" type="text/javascript">_</script>
<script src="https://zoggy.github.io/xtmpl/bootstrap-collapse.js" type="text/javascript">_</script>

</body>
</html>